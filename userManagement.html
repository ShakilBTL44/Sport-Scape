<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Panel - User Management</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="global.css" />
    <style>
      /* Sidebar Styles */
      .sidebar {
        width: 250px;
        background-color: white;
        box-shadow: var(--box-shadow);
        transition: var(--transition);
        z-index: 100;
        position: fixed;
        height: 100vh;
      }

      /* .sidebar-header {
        padding: 20px;
        border-bottom: 1px solid var(--light-gray);

      } */

      .sidebar-header h2 {
        color: var(--primary-color);
        font-weight: 600;
      }

      .sidebar-nav ul {
        list-style: none;
        padding: 20px 0;
      }

      .sidebar-nav li a {
        display: flex;
        align-items: center;
        padding: 12px 20px;
        color: var(--gray-color);
        text-decoration: none;
        transition: var(--transition);
      }

      .sidebar-nav li a i {
        margin-right: 10px;
        width: 20px;
        text-align: center;
      }

      .sidebar-nav li a:hover {
        background-color: var(--primary-light);
        color: var(--primary-color);
      }

      .sidebar-nav li.active a {
        background-color: var(--primary-light);
        color: var(--primary-color);
        border-left: 3px solid var(--primary-color);
      }

      /* Main Content Styles */
      .main-content {
        flex: 1;
        margin-left: 250px;
        transition: var(--transition);
        padding-bottom: 20px;
        width: calc(100vw - var(--sidebar-width));
      }

      /* Top Navbar Styles */
      .top-navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 25px;
        background-color: white;
        box-shadow: var(--box-shadow);
        position: sticky;
        top: 0;
        z-index: 90;
      }

      .sidebar-toggle {
        background: none;
        border: none;
        font-size: 1.2rem;
        margin-right: 15px;
        cursor: pointer;
        color: var(--gray-color);
        display: none;
      }

      .top-navbar h1 {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--dark-color);
      }

      /* Filters Section */
      .filters-section {
        background-color: white;
        margin: 25px;
        padding: 20px;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
      }

      .search-box {
        position: relative;
      }

      .search-box i {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray-color);
      }

      .search-box input {
        width: 100%;
        padding: 12px 20px 12px 45px;
        border: 1px solid var(--light-gray);
        border-radius: var(--border-radius);
        font-family: "Poppins", sans-serif;
        transition: var(--transition);
      }

      .search-box input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px var(--primary-light);
      }

      .filter-dropdowns {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        margin-top: 15px;
      }

      .dropdown {
        position: relative;
      }

      .dropdown-btn {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 15px;
        background-color: white;
        border: 1px solid var(--light-gray);
        border-radius: var(--border-radius);
        cursor: pointer;
        font-family: "Poppins", sans-serif;
        transition: var(--transition);
      }

      .dropdown-btn:hover {
        background-color: var(--light-gray);
      }

      .dropdown-btn i:first-child {
        color: var(--primary-color);
      }

      .dropdown-content {
        display: none;
        position: absolute;
        background-color: white;
        min-width: 200px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        z-index: 1;
        border-radius: var(--border-radius);
        padding: 10px;
        margin-top: 5px;
        border: 1px solid var(--light-gray);
      }

      .dropdown-search {
        margin-bottom: 10px;
      }

      .dropdown-search input {
        width: 100%;
        padding: 8px 10px;
        border: 1px solid var(--light-gray);
        border-radius: 5px;
        font-family: "Poppins", sans-serif;
      }

      .dropdown-options {
        max-height: 200px;
        overflow-y: auto;
      }

      .dropdown-option {
        padding: 8px 10px;
        cursor: pointer;
        border-radius: 5px;
        transition: var(--transition);
      }

      .dropdown-option:hover {
        background-color: var(--primary-light);
        color: var(--primary-color);
      }

      .dropdown-option.selected {
        background-color: var(--primary-light);
        color: var(--primary-color);
        font-weight: 500;
      }

      .date-range-picker {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .date-input {
        display: flex;
        flex-direction: column;
      }

      .date-input label {
        font-size: 0.8rem;
        color: var(--gray-color);
        margin-bottom: 5px;
      }

      .date-input input {
        padding: 8px;
        border: 1px solid var(--light-gray);
        border-radius: 5px;
        font-family: "Poppins", sans-serif;
      }

      .apply-btn {
        padding: 8px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: var(--transition);
        font-family: "Poppins", sans-serif;
      }

      .apply-btn:hover {
        background-color: var(--secondary-color);
      }

      .reset-filters {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 15px;
        background-color: white;
        border: 1px solid var(--light-gray);
        border-radius: var(--border-radius);
        cursor: pointer;
        font-family: "Poppins", sans-serif;
        transition: var(--transition);
        color: var(--gray-color);
      }

      .reset-filters:hover {
        background-color: var(--light-gray);
        color: var(--dark-color);
      }

      /* Users Table Styles */
      .users-table-container {
        background-color: white;
        margin: 0 25px;
        /* padding: 20px; */
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        overflow: hidden;
      }

      .users-table {
        width: 100%;
        border-collapse: collapse;
      }
      /* 
      .users-table th {
        text-align: left;
        padding: 12px 15px;
        background-color: var(--light-gray);
        font-weight: 600;
        color: var(--dark-color);
      } */

      .users-table th {
        background-color: var(--primary-color);
        color: white;
        padding: 15px;
        text-align: left;
        font-weight: 500;
      }

      .users-table td {
        padding: 12px 15px;
        border-bottom: 1px solid var(--light-gray);
        vertical-align: middle;
      }

      .users-table tr:last-child td {
        border-bottom: none;
      }

      .users-table tr:hover {
        background-color: var(--primary-light);
      }

      .user-cell {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .action-btn {
        background: none;
        border: none;
        cursor: pointer;
        color: var(--gray-color);
        font-size: 1rem;
        padding: 5px;
        border-radius: 5px;
        transition: var(--transition);
      }

      .action-btn:hover {
        color: var(--primary-color);
        background-color: var(--primary-light);
      }

      /* Table Footer */
      .table-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 20px;
        padding: 15px 25px;
        border-top: 1px solid var(--light-gray);
      }

      .pagination-info {
        color: var(--gray-color);
        font-size: 0.9rem;
      }

      .pagination-controls {
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .pagination-btn {
        width: 35px;
        height: 35px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: white;
        border: 1px solid var(--light-gray);
        border-radius: 5px;
        cursor: pointer;
        transition: var(--transition);
      }

      .pagination-btn:hover:not(:disabled) {
        background-color: var(--primary-light);
        color: var(--primary-color);
        border-color: var(--primary-light);
      }

      .pagination-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .page-numbers {
        display: flex;
        gap: 5px;
      }

      .page-number {
        width: 35px;
        height: 35px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 5px;
        cursor: pointer;
        transition: var(--transition);
      }

      .page-number:hover {
        background-color: var(--primary-light);
        color: var(--primary-color);
      }

      .page-number.current-page {
        background-color: var(--primary-color);
        color: white;
      }

      /* Modal Styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
      }

      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .modal-content {
        background-color: white;
        border-radius: var(--border-radius);
        width: 90%;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
        padding: 25px;
        position: relative;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        animation: modalFadeIn 0.3s ease;
      }

      @keyframes modalFadeIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .modal-close {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 1.2rem;
        cursor: pointer;
        color: var(--gray-color);
        transition: var(--transition);
      }

      .modal-close:hover {
        color: var(--danger-color);
      }

      .user-detail-header {
        display: flex;
        gap: 20px;
        margin-bottom: 25px;
        align-items: center;
      }

      .user-detail-header .user-avatar {
        width: 80px;
        height: 80px;
        border-radius: var(--border-radius);
      }

      .user-info h2 {
        margin-bottom: 5px;
        color: var(--dark-color);
      }

      .user-info p {
        color: var(--gray-color);
        font-size: 0.9rem;
      }

      .detail-row {
        display: flex;
        gap: 15px;
        margin-bottom: 15px;
        align-items: flex-start;
      }

      .detail-row i {
        color: var(--primary-color);
        font-size: 1.2rem;
        margin-top: 3px;
      }

      .detail-row h4 {
        font-size: 0.9rem;
        color: var(--gray-color);
        margin-bottom: 3px;
      }

      .detail-row p {
        color: var(--dark-color);
        font-weight: 500;
      }

      /* Responsive Styles */
      @media (max-width: 992px) {
        .sidebar {
          transform: translateX(-100%);
          position: fixed;
        }

        .sidebar.active {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0;
          width: 100vw;
        }

        .sidebar-toggle {
          display: block;
        }
      }

      @media (max-width: 768px) {
        .filters-section {
          margin: 10px;
          padding: 15px;
        }

        .users-table-container {
          margin: 0 10px;
          padding: 15px;
        }

        .users-table th,
        .users-table td {
          padding: 10px;
        }

        .filter-dropdowns {
          flex-direction: column;
        }

        .dropdown {
          width: 100%;
        }

        .dropdown-btn,
        .reset-filters {
          width: 100%;
          justify-content: center;
        }

        .table-footer {
          flex-direction: column;
          gap: 15px;
          align-items: flex-start;
        }

        .pagination-controls {
          width: 100%;
          justify-content: space-between;
        }
      }

      @media (max-width: 576px) {
        .users-table {
          display: block;
          overflow-x: auto;
          white-space: nowrap;
        }

        .user-detail-header {
          flex-direction: column;
          text-align: center;
        }

        .user-info {
          text-align: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Sidebar -->
      <aside class="sidebar"></aside>

      <!-- Main Content Area -->
      <main class="main-content">
        <!-- Navbar -->
        <nav class="navbar"></nav>

        <!-- Filters and Search -->
        <div class="filters-section">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input
              type="text"
              id="user-search"
              placeholder="Search by name, email, or city..."
              aria-label="Search users"
            />
          </div>
          <div class="filter-dropdowns">
            <div class="dropdown">
              <button
                class="dropdown-btn"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <i class="fas fa-filter"></i>
                Filter by City
                <i class="fas fa-chevron-down"></i>
              </button>
              <div class="dropdown-content">
                <div class="dropdown-search">
                  <input
                    type="text"
                    placeholder="Search cities..."
                    id="city-search"
                  />
                </div>
                <div class="dropdown-options" id="city-options">
                  <!-- Options will be populated by JS -->
                </div>
              </div>
            </div>
            <div class="dropdown hide">
              <button
                class="dropdown-btn"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <i class="fas fa-calendar"></i>
                Filter by Date
                <i class="fas fa-chevron-down"></i>
              </button>
              <div class="dropdown-content">
                <div class="date-range-picker">
                  <div class="date-input">
                    <label for="start-date">From:</label>
                    <input type="date" id="start-date" />
                  </div>
                  <div class="date-input">
                    <label for="end-date">To:</label>
                    <input type="date" id="end-date" />
                  </div>
                  <button class="apply-btn">Apply</button>
                </div>
              </div>
            </div>
            <button class="reset-filters" id="reset-filters">
              <i class="fas fa-sync-alt"></i>
              Reset Filters
            </button>
          </div>
        </div>

        <!-- Users Table -->
        <div class="users-table-container">
          <table class="users-table" aria-label="Users list">
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>City</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="users-table-body">
              <!-- Users will be populated by JS -->
            </tbody>
          </table>
          <div class="table-footer">
            <div class="pagination-info">
              Showing <span id="showing-from">1</span>-<span id="showing-to"
                >10</span
              >
              of <span id="total-users">50</span> users
            </div>
            <div class="pagination-controls">
              <button class="pagination-btn" id="prev-page" disabled>
                <i class="fas fa-chevron-left"></i>
              </button>
              <span class="page-numbers" id="page-numbers">
                <span class="current-page">1</span>
              </span>
              <button class="pagination-btn" id="next-page">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>
      </main>

      <!-- User Details Modal -->
      <div class="modal-overlay" id="user-modal" aria-hidden="true">
        <div class="modal-content">
          <button class="modal-close" aria-label="Close modal">
            <i class="fas fa-times"></i>
          </button>
          <div class="user-detail-header">
            <div class="user-avatar">
              <img id="detail-user-img" src="" alt="User avatar" />
            </div>
            <div class="user-info">
              <h2 id="detail-user-name"></h2>
              <p id="detail-user-email"></p>
              <p id="detail-user-joined"></p>
            </div>
          </div>
          <div class="user-detail-body">
            <div class="detail-row">
              <i class="fas fa-map-marker-alt"></i>
              <div>
                <h4>Address</h4>
                <p id="detail-user-address"></p>
              </div>
            </div>
            <div class="detail-row">
              <i class="fas fa-phone"></i>
              <div>
                <h4>Phone</h4>
                <p id="detail-user-phone"></p>
              </div>
            </div>
            <div class="detail-row">
              <i class="fas fa-city"></i>
              <div>
                <h4>City</h4>
                <p id="detail-user-city"></p>
              </div>
            </div>
            <div class="detail-row">
              <i class="fas fa-globe"></i>
              <div>
                <h4>Country</h4>
                <p id="detail-user-country"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script type="module">
    import Sidebar from "./sidebar.js";
    import Navbar from "./navbar.js";

    document.addEventListener("DOMContentLoaded", function () {
      const sidebar = document.querySelector(".sidebar");
      const navbar = document.querySelector(".navbar");
      sidebar.innerHTML = Sidebar("UserManagement");
      navbar.innerHTML = Navbar("User Management");
      // Sample user data
      const users = [
        {
          id: 1,
          name: "Oliver Smith",
          email: "oliver.smith@example.com",
          phone: "+61 412 345 678",
          city: "Sydney",
          address: "12 Harbour St, Sydney, NSW 2000",
          country: "Australia",
          joined: "2022-05-15",
          image: "https://randomuser.me/api/portraits/men/21.jpg",
        },
        {
          id: 2,
          name: "Charlotte Johnson",
          email: "charlotte.johnson@example.com",
          phone: "+61 423 678 910",
          city: "Melbourne",
          address: "25 Queen St, Melbourne, VIC 3000",
          country: "Australia",
          joined: "2022-06-10",
          image: "https://randomuser.me/api/portraits/women/45.jpg",
        },
        {
          id: 3,
          name: "Liam Williams",
          email: "liam.williams@example.com",
          phone: "+61 434 567 890",
          city: "Brisbane",
          address: "88 King St, Brisbane, QLD 4000",
          country: "Australia",
          joined: "2022-07-05",
          image: "https://randomuser.me/api/portraits/men/34.jpg",
        },
        {
          id: 4,
          name: "Amelia Brown",
          email: "amelia.brown@example.com",
          phone: "+61 445 789 012",
          city: "Perth",
          address: "50 St Georges Terrace, Perth, WA 6000",
          country: "Australia",
          joined: "2022-08-12",
          image: "https://randomuser.me/api/portraits/women/29.jpg",
        },
        {
          id: 5,
          name: "Noah Wilson",
          email: "noah.wilson@example.com",
          phone: "+61 456 901 234",
          city: "Adelaide",
          address: "15 North Terrace, Adelaide, SA 5000",
          country: "Australia",
          joined: "2022-09-08",
          image: "https://randomuser.me/api/portraits/men/50.jpg",
        },
        {
          id: 6,
          name: "Isla Davis",
          email: "isla.davis@example.com",
          phone: "+61 467 123 456",
          city: "Canberra",
          address: "33 Parliament Dr, Canberra, ACT 2600",
          country: "Australia",
          joined: "2022-10-22",
          image: "https://randomuser.me/api/portraits/women/30.jpg",
        },
        {
          id: 7,
          name: "James Anderson",
          email: "james.anderson@example.com",
          phone: "+61 478 234 567",
          city: "Gold Coast",
          address: "77 Surfers Paradise Blvd, Gold Coast, QLD 4217",
          country: "Australia",
          joined: "2022-11-05",
          image: "https://randomuser.me/api/portraits/men/27.jpg",
        },
        {
          id: 8,
          name: "Sophia Martinez",
          email: "sophia.martinez@example.com",
          phone: "+61 489 345 678",
          city: "Hobart",
          address: "90 Salamanca Pl, Hobart, TAS 7000",
          country: "Australia",
          joined: "2022-12-18",
          image: "https://randomuser.me/api/portraits/women/41.jpg",
        },
        {
          id: 9,
          name: "Benjamin White",
          email: "benjamin.white@example.com",
          phone: "+61 490 456 789",
          city: "Darwin",
          address: "21 Smith St, Darwin, NT 0800",
          country: "Australia",
          joined: "2023-01-12",
          image: "https://randomuser.me/api/portraits/men/36.jpg",
        },
        {
          id: 10,
          name: "Emily Harris",
          email: "emily.harris@example.com",
          phone: "+61 401 567 890",
          city: "Newcastle",
          address: "102 Hunter St, Newcastle, NSW 2300",
          country: "Australia",
          joined: "2023-02-05",
          image: "https://randomuser.me/api/portraits/women/32.jpg",
        },
        {
          id: 11,
          name: "Daniel King",
          email: "daniel.king@example.com",
          phone: "+61 412 678 901",
          city: "Wollongong",
          address: "18 Crown St, Wollongong, NSW 2500",
          country: "Australia",
          joined: "2023-03-10",
          image: "https://randomuser.me/api/portraits/men/48.jpg",
        },
        {
          id: 12,
          name: "Ava Lee",
          email: "ava.lee@example.com",
          phone: "+61 423 789 012",
          city: "Geelong",
          address: "45 Ryrie St, Geelong, VIC 3220",
          country: "Australia",
          joined: "2023-04-15",
          image: "https://randomuser.me/api/portraits/women/47.jpg",
        },
        {
          id: 13,
          name: "Ethan Scott",
          email: "ethan.scott@example.com",
          phone: "+61 434 890 123",
          city: "Cairns",
          address: "32 Esplanade, Cairns, QLD 4870",
          country: "Australia",
          joined: "2023-05-22",
          image: "https://randomuser.me/api/portraits/men/51.jpg",
        },
        {
          id: 14,
          name: "Mia Turner",
          email: "mia.turner@example.com",
          phone: "+61 445 901 234",
          city: "Townsville",
          address: "56 Flinders St, Townsville, QLD 4810",
          country: "Australia",
          joined: "2023-06-30",
          image: "https://randomuser.me/api/portraits/women/53.jpg",
        },
        {
          id: 15,
          name: "Lucas Baker",
          email: "lucas.baker@example.com",
          phone: "+61 456 012 345",
          city: "Toowoomba",
          address: "74 Margaret St, Toowoomba, QLD 4350",
          country: "Australia",
          joined: "2023-07-18",
          image: "https://randomuser.me/api/portraits/men/38.jpg",
        },
        {
          id: 16,
          name: "Harper Cooper",
          email: "harper.cooper@example.com",
          phone: "+61 467 123 678",
          city: "Ballarat",
          address: "67 Lydiard St, Ballarat, VIC 3350",
          country: "Australia",
          joined: "2023-08-25",
          image: "https://randomuser.me/api/portraits/women/50.jpg",
        },
        {
          id: 17,
          name: "Henry Young",
          email: "henry.young@example.com",
          phone: "+61 478 234 890",
          city: "Bendigo",
          address: "83 Mitchell St, Bendigo, VIC 3550",
          country: "Australia",
          joined: "2023-09-14",
          image: "https://randomuser.me/api/portraits/men/42.jpg",
        },
        {
          id: 18,
          name: "Ella Stewart",
          email: "ella.stewart@example.com",
          phone: "+61 489 345 901",
          city: "Launceston",
          address: "55 George St, Launceston, TAS 7250",
          country: "Australia",
          joined: "2023-10-07",
          image: "https://randomuser.me/api/portraits/women/37.jpg",
        },
        {
          id: 19,
          name: "Jack Morris",
          email: "jack.morris@example.com",
          phone: "+61 490 456 123",
          city: "Alice Springs",
          address: "9 Todd St, Alice Springs, NT 0870",
          country: "Australia",
          joined: "2023-11-19",
          image: "https://randomuser.me/api/portraits/men/31.jpg",
        },
        {
          id: 20,
          name: "Grace Robinson",
          email: "grace.robinson@example.com",
          phone: "+61 401 567 234",
          city: "Rockhampton",
          address: "20 Quay St, Rockhampton, QLD 4700",
          country: "Australia",
          joined: "2023-12-05",
          image: "https://randomuser.me/api/portraits/women/40.jpg",
        },
      ];

      // DOM elements
      // const sidebarToggle = document.querySelector(".sidebar-toggle");
      const usersTableBody = document.getElementById("users-table-body");
      const userSearch = document.getElementById("user-search");
      const cityOptions = document.getElementById("city-options");
      const citySearch = document.getElementById("city-search");
      const startDate = document.getElementById("start-date");
      const endDate = document.getElementById("end-date");
      const applyBtn = document.querySelector(".apply-btn");
      const resetFiltersBtn = document.getElementById("reset-filters");
      const userModal = document.getElementById("user-modal");
      const modalClose = document.querySelector(".modal-close");
      const prevPageBtn = document.getElementById("prev-page");
      const nextPageBtn = document.getElementById("next-page");
      const pageNumbers = document.getElementById("page-numbers");
      const showingFrom = document.getElementById("showing-from");
      const showingTo = document.getElementById("showing-to");
      const totalUsers = document.getElementById("total-users");
      const menuToggle = document.querySelector(".menu-toggle");

      // State variables
      let currentPage = 1;
      const usersPerPage = 10;
      let filteredUsers = [...users];
      let selectedCities = [];

      // Initialize the page
      init();

      function init() {
        renderUsersTable();
        setupCityFilter();
        setupEventListeners();
        updatePagination();
      }

      function setupEventListeners() {
        // Navbar Toggle
        menuToggle.addEventListener("click", toggleSidebar);

        // Sidebar toggle
        // sidebarToggle.addEventListener("click", toggleSidebar);

        // Search functionality
        userSearch.addEventListener("input", handleSearch);

        // City filter
        document.querySelectorAll(".dropdown-btn").forEach((btn) => {
          btn.addEventListener("click", function () {
            const dropdown = this.nextElementSibling;
            const isExpanded = this.getAttribute("aria-expanded") === "true";

            // Close all other dropdowns
            document
              .querySelectorAll(".dropdown-content")
              .forEach((content) => {
                if (content !== dropdown) {
                  content.style.display = "none";
                  content.previousElementSibling.setAttribute(
                    "aria-expanded",
                    "false"
                  );
                }
              });

            // Toggle current dropdown
            dropdown.style.display = isExpanded ? "none" : "block";
            this.setAttribute("aria-expanded", String(!isExpanded));
          });
        });

        // Close dropdowns when clicking outside
        document.addEventListener("click", function (e) {
          if (!e.target.closest(".dropdown")) {
            document
              .querySelectorAll(".dropdown-content")
              .forEach((content) => {
                content.style.display = "none";
                content.previousElementSibling.setAttribute(
                  "aria-expanded",
                  "false"
                );
              });
          }
        });

        // City search in dropdown
        citySearch.addEventListener("input", filterCityOptions);

        // Date filter
        applyBtn.addEventListener("click", applyDateFilter);

        // Reset filters
        resetFiltersBtn.addEventListener("click", resetFilters);

        // Modal close
        modalClose.addEventListener("click", closeModal);
        userModal.addEventListener("click", function (e) {
          if (e.target === userModal) {
            closeModal();
          }
        });

        // Pagination
        prevPageBtn.addEventListener("click", goToPrevPage);
        nextPageBtn.addEventListener("click", goToNextPage);

        // Keyboard navigation
        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape") {
            closeModal();
          }
        });
      }

      // Toggle sidebar on mobile
      function toggleSidebar() {
        sidebar.classList.toggle("active");
      }

      function renderUsersTable() {
        usersTableBody.innerHTML = "";

        const paginatedUsers = getPaginatedUsers();

        paginatedUsers.forEach((user) => {
          const row = document.createElement("tr");
          row.innerHTML = `
                <td>
                    <div class="user-cell">
                        <div class="user-avatar">
                            <img src="${user.image}" alt="${user.name}">
                        </div>
                        <span class="user-name">${user.name}</span>
                    </div>
                </td>
                <td>${user.email}</td>
                <td>${user.city}</td>
                <td>
                    <button class="action-btn view-btn" data-id="${user.id}" aria-label="View details of ${user.name}">
                        <i class="fas fa-eye"></i>
                    </button>
                </td>
            `;
          usersTableBody.appendChild(row);
        });

        // Add event listeners to view buttons
        document.querySelectorAll(".view-btn").forEach((btn) => {
          btn.addEventListener("click", function () {
            const userId = parseInt(this.getAttribute("data-id"));
            showUserDetails(userId);
          });
        });
      }

      function getPaginatedUsers() {
        const startIndex = (currentPage - 1) * usersPerPage;
        const endIndex = startIndex + usersPerPage;
        return filteredUsers.slice(startIndex, endIndex);
      }

      function setupCityFilter() {
        // Get unique cities from users
        const cities = [...new Set(users.map((user) => user.city))];

        cityOptions.innerHTML = cities
          .map(
            (city) => `
            <div class="dropdown-option" data-city="${city}">${city}</div>
        `
          )
          .join("");

        // Add event listeners to city options
        document.querySelectorAll(".dropdown-option").forEach((option) => {
          option.addEventListener("click", function () {
            const city = this.getAttribute("data-city");
            toggleCitySelection(city);
          });
        });
      }

      function toggleCitySelection(city) {
        const option = document.querySelector(
          `.dropdown-option[data-city="${city}"]`
        );

        if (selectedCities.includes(city)) {
          selectedCities = selectedCities.filter((c) => c !== city);
          option.classList.remove("selected");
        } else {
          selectedCities.push(city);
          option.classList.add("selected");
        }

        filterUsers();
      }

      function filterCityOptions() {
        const searchTerm = citySearch.value.toLowerCase();
        document.querySelectorAll(".dropdown-option").forEach((option) => {
          const city = option.getAttribute("data-city").toLowerCase();
          if (city.includes(searchTerm)) {
            option.style.display = "block";
          } else {
            option.style.display = "none";
          }
        });
      }

      function handleSearch() {
        filterUsers();
      }

      function applyDateFilter() {
        filterUsers();
        // Close the dropdown
        document.querySelector(".dropdown-content").style.display = "none";
        document
          .querySelector('.dropdown-btn[aria-expanded="true"]')
          .setAttribute("aria-expanded", "false");
      }

      function filterUsers() {
        const searchTerm = userSearch.value.toLowerCase();
        const startDateValue = startDate.value;
        const endDateValue = endDate.value;

        filteredUsers = users.filter((user) => {
          // Search filter
          const matchesSearch =
            user.name.toLowerCase().includes(searchTerm) ||
            user.email.toLowerCase().includes(searchTerm) ||
            user.city.toLowerCase().includes(searchTerm);

          // City filter
          const matchesCity =
            selectedCities.length === 0 || selectedCities.includes(user.city);

          // Date filter
          let matchesDate = true;
          if (startDateValue || endDateValue) {
            const joinedDate = new Date(user.joined);
            const start = startDateValue ? new Date(startDateValue) : null;
            const end = endDateValue ? new Date(endDateValue) : null;

            if (start && joinedDate < start) matchesDate = false;
            if (end && joinedDate > end) matchesDate = false;
          }

          return matchesSearch && matchesCity && matchesDate;
        });

        // Reset to first page when filters change
        currentPage = 1;
        renderUsersTable();
        updatePagination();
      }

      function resetFilters() {
        userSearch.value = "";
        startDate.value = "";
        endDate.value = "";
        selectedCities = [];

        // Reset city options UI
        document.querySelectorAll(".dropdown-option").forEach((option) => {
          option.classList.remove("selected");
        });

        // Reset dropdown UI
        document.querySelectorAll(".dropdown-content").forEach((content) => {
          content.style.display = "none";
          content.previousElementSibling.setAttribute("aria-expanded", "false");
        });

        // Reset city search
        citySearch.value = "";
        filterCityOptions();

        // Reset filtered users
        filteredUsers = [...users];
        currentPage = 1;
        renderUsersTable();
        updatePagination();
      }

      function showUserDetails(userId) {
        const user = users.find((u) => u.id === userId);
        if (!user) return;

        // Format joined date
        const joinedDate = new Date(user.joined);
        const formattedDate = joinedDate.toLocaleDateString("en-US", {
          year: "numeric",
          month: "long",
          day: "numeric",
        });

        // Populate modal
        document.getElementById("detail-user-img").src = user.image;
        document.getElementById("detail-user-img").alt = user.name;
        document.getElementById("detail-user-name").textContent = user.name;
        document.getElementById("detail-user-email").textContent = user.email;
        document.getElementById(
          "detail-user-joined"
        ).textContent = `Joined ${formattedDate}`;
        document.getElementById("detail-user-address").textContent =
          user.address;
        document.getElementById("detail-user-phone").textContent = user.phone;
        document.getElementById("detail-user-city").textContent = user.city;
        document.getElementById("detail-user-country").textContent =
          user.country;

        // Show modal
        userModal.classList.add("active");
        userModal.setAttribute("aria-hidden", "false");
        document.body.style.overflow = "hidden";
      }

      function closeModal() {
        userModal.classList.remove("active");
        userModal.setAttribute("aria-hidden", "true");
        document.body.style.overflow = "";
      }

      function updatePagination() {
        const totalPages = Math.ceil(filteredUsers.length / usersPerPage);

        // Update showing X-Y of Z users
        const from = (currentPage - 1) * usersPerPage + 1;
        const to = Math.min(currentPage * usersPerPage, filteredUsers.length);
        showingFrom.textContent = from;
        showingTo.textContent = to;
        totalUsers.textContent = filteredUsers.length;

        // Update pagination buttons
        prevPageBtn.disabled = currentPage === 1;
        nextPageBtn.disabled = currentPage === totalPages || totalPages === 0;

        // Update page numbers
        pageNumbers.innerHTML = "";

        if (totalPages <= 5) {
          // Show all pages
          for (let i = 1; i <= totalPages; i++) {
            const page = document.createElement("span");
            page.className = `page-number ${
              i === currentPage ? "current-page" : ""
            }`;
            page.textContent = i;
            page.addEventListener("click", () => goToPage(i));
            pageNumbers.appendChild(page);
          }
        } else {
          // Show limited pages with ellipsis
          if (currentPage <= 3) {
            // Show first 3 pages, ellipsis, last page
            for (let i = 1; i <= 3; i++) {
              const page = document.createElement("span");
              page.className = `page-number ${
                i === currentPage ? "current-page" : ""
              }`;
              page.textContent = i;
              page.addEventListener("click", () => goToPage(i));
              pageNumbers.appendChild(page);
            }

            const ellipsis = document.createElement("span");
            ellipsis.textContent = "...";
            pageNumbers.appendChild(ellipsis);

            const lastPage = document.createElement("span");
            lastPage.className = "page-number";
            lastPage.textContent = totalPages;
            lastPage.addEventListener("click", () => goToPage(totalPages));
            pageNumbers.appendChild(lastPage);
          } else if (currentPage >= totalPages - 2) {
            // Show first page, ellipsis, last 3 pages
            const firstPage = document.createElement("span");
            firstPage.className = "page-number";
            firstPage.textContent = 1;
            firstPage.addEventListener("click", () => goToPage(1));
            pageNumbers.appendChild(firstPage);

            const ellipsis = document.createElement("span");
            ellipsis.textContent = "...";
            pageNumbers.appendChild(ellipsis);

            for (let i = totalPages - 2; i <= totalPages; i++) {
              const page = document.createElement("span");
              page.className = `page-number ${
                i === currentPage ? "current-page" : ""
              }`;
              page.textContent = i;
              page.addEventListener("click", () => goToPage(i));
              pageNumbers.appendChild(page);
            }
          } else {
            // Show first page, ellipsis, current-1, current, current+1, ellipsis, last page
            const firstPage = document.createElement("span");
            firstPage.className = "page-number";
            firstPage.textContent = 1;
            firstPage.addEventListener("click", () => goToPage(1));
            pageNumbers.appendChild(firstPage);

            const ellipsis1 = document.createElement("span");
            ellipsis1.textContent = "...";
            pageNumbers.appendChild(ellipsis1);

            for (let i = currentPage - 1; i <= currentPage + 1; i++) {
              const page = document.createElement("span");
              page.className = `page-number ${
                i === currentPage ? "current-page" : ""
              }`;
              page.textContent = i;
              page.addEventListener("click", () => goToPage(i));
              pageNumbers.appendChild(page);
            }

            const ellipsis2 = document.createElement("span");
            ellipsis2.textContent = "...";
            pageNumbers.appendChild(ellipsis2);

            const lastPage = document.createElement("span");
            lastPage.className = "page-number";
            lastPage.textContent = totalPages;
            lastPage.addEventListener("click", () => goToPage(totalPages));
            pageNumbers.appendChild(lastPage);
          }
        }
      }

      function goToPage(page) {
        if (page < 1 || page > Math.ceil(filteredUsers.length / usersPerPage))
          return;
        currentPage = page;
        renderUsersTable();
        updatePagination();
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function goToPrevPage() {
        goToPage(currentPage - 1);
      }

      function goToNextPage() {
        goToPage(currentPage + 1);
      }
    });
  </script>
</html>
