<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Panel - Events Management</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="global.css" />
    <style>
      .menu-item {
        padding: 12px 20px;
        display: flex;
        align-items: center;
        color: #555;
        text-decoration: none;
        transition: all 0.2s ease;
        border-left: 3px solid transparent;
      }

      .menu-item:hover {
        background-color: rgba(67, 97, 238, 0.1);
        color: var(--primary-color);
        border-left: 3px solid var(--primary-color);
      }

      .menu-item.active {
        background-color: rgba(67, 97, 238, 0.1);
        color: var(--primary-color);
        border-left: 3px solid var(--primary-color);
        font-weight: 500;
      }

      .menu-item i {
        margin-right: 10px;
        font-size: 18px;
      }

      /* Main Content Styles */
      .main-content {
        flex: 1;
        margin-left: var(--sidebar-width);
        transition: all var(--transition-speed) ease;
        width: calc(100vw - var(--sidebar-width));
      }

      /* Content Area Styles */

      .page-title {
        font-size: 24px;
        font-weight: 600;
        color: var(--dark-color);
      }

      .btn-outline {
        background-color: transparent;
        border: 1px solid var(--primary-color);
        color: var(--primary-color);
      }

      .btn-outline:hover {
        background-color: rgba(67, 97, 238, 0.1);
      }

      /* Filter Section Styles */
      .filter-section {
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        margin-bottom: 20px;
      }

      .filter-title {
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 15px;
        color: var(--dark-color);
      }

      .filter-form {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 15px;
      }

      .form-group {
        margin-bottom: 0;
      }

      .form-label {
        display: block;
        margin-bottom: 5px;
        font-size: 14px;
        color: #555;
      }

      .form-control {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        transition: border-color 0.2s ease;
      }

      .form-control:focus {
        outline: none;
        border-color: var(--primary-color);
      }

      .filter-actions {
        display: flex;
        align-items: flex-end;
        gap: 10px;
      }

      /* Table Styles */
      .table-container {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        overflow: hidden;
      }

      .table {
        width: 100%;
        border-collapse: collapse;
      }

      .table thead {
        background-color: #f8f9fa;
      }

      .table th {
        padding: 12px 15px;
        text-align: left;
        font-weight: 500;
        color: #555;
        font-size: 14px;
      }

      .table td {
        padding: 12px 15px;
        border-top: 1px solid #eee;
        font-size: 14px;
      }

      .table tr:hover {
        background-color: #f8f9fa;
      }

      .table tr:nth-child(even) {
        background-color: #fafafa;
      }

      .table tr:nth-child(even):hover {
        background-color: #f8f9fa;
      }

      .event-image {
        width: 50px;
        height: 50px;
        border-radius: 10px;
        object-fit: cover;
      }

      .badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
      }

      .badge-primary {
        background-color: rgba(67, 97, 238, 0.1);
        color: var(--primary-color);
      }

      .badge-success {
        background-color: rgba(76, 201, 240, 0.1);
        color: var(--success-color);
      }

      .badge-warning {
        background-color: rgba(248, 150, 30, 0.1);
        color: var(--warning-color);
      }

      .badge-danger {
        background-color: rgba(247, 37, 133, 0.1);
        color: var(--danger-color);
      }

      .action-buttons {
        display: flex;
        gap: 8px;
      }

      .action-btn {
        width: 30px;
        height: 30px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
        background-color: transparent;
        border: 1px solid #ddd;
        color: #555;
      }

      .action-btn:hover {
        background-color: #f8f9fa;
        color: var(--primary-color);
        border-color: var(--primary-color);
      }

      /* Modal Styles */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        overflow-y: auto;
      }

      .modal-content {
        background-color: white;
        margin: 50px auto;
        width: 90%;
        max-width: 800px;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        animation: modalFadeIn 0.3s ease;
      }

      @keyframes modalFadeIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .modal-header {
        padding: 15px 20px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--dark-color);
      }

      .modal-close {
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
        color: #777;
        transition: color 0.2s ease;
      }

      .modal-close:hover {
        color: var(--danger-color);
      }

      .modal-body {
        padding: 20px;
      }

      .modal-footer {
        padding: 15px 20px;
        border-top: 1px solid #eee;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }

      /* Form Styles */
      .form-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }

      .form-full-row {
        grid-column: 1 / -1;
      }

      .radio-group {
        display: flex;
        gap: 20px;
      }

      .radio-option {
        display: flex;
        align-items: center;
      }

      .radio-option input {
        margin-right: 8px;
      }

      /* Mapping Section Styles */
      .mapping-section {
        display: none;
        margin-top: 20px;
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .mapping-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .mapping-title {
        font-size: 16px;
        font-weight: 500;
        color: var(--dark-color);
      }

      .mapping-close {
        background: none;
        border: none;
        font-size: 16px;
        cursor: pointer;
        color: #777;
      }

      .mapping-close:hover {
        color: var(--danger-color);
      }

      .mapping-container {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        gap: 20px;
        align-items: start;
      }

      .mapping-list {
        border: 1px solid #ddd;
        border-radius: 4px;
        min-height: 300px;
        max-height: 400px;
        overflow-y: auto;
      }

      .mapping-list-header {
        padding: 10px;
        background-color: #f8f9fa;
        border-bottom: 1px solid #ddd;
        font-weight: 500;
        font-size: 14px;
      }

      .mapping-list-content {
        padding: 10px;
      }

      .mapping-item {
        padding: 8px 10px;
        border: 1px solid #eee;
        border-radius: 4px;
        margin-bottom: 5px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 14px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .mapping-item:hover {
        background-color: #f8f9fa;
        border-color: #ddd;
      }

      .mapping-item.selected {
        background-color: rgba(67, 97, 238, 0.1);
        border-color: var(--primary-color);
      }

      .mapping-controls {
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 10px;
      }

      .mapping-btn {
        width: 40px;
        height: 40px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        background-color: var(--primary-color);
        color: white;
        border: none;
        transition: all 0.2s ease;
      }

      .mapping-btn:hover {
        background-color: var(--secondary-color);
      }

      .mapping-btn i {
        font-size: 16px;
      }

      .mapped-item-controls {
        display: flex;
        gap: 5px;
      }

      .mapped-item-btn {
        width: 25px;
        height: 25px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        background-color: #f8f9fa;
        color: #555;
        border: 1px solid #ddd;
        transition: all 0.2s ease;
        font-size: 12px;
      }

      .mapped-item-btn:hover {
        background-color: #eee;
      }

      /* Responsive Styles */
      @media (max-width: 992px) {
        .sidebar {
          transform: translateX(-100%);
          z-index: 1000;
        }

        .sidebar.active {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0;
          width: 100vw;
        }

        .navbar-toggle {
          display: block;
        }
      }

      @media (max-width: 768px) {
        .filter-form {
          grid-template-columns: 1fr;
        }

        .mapping-container {
          grid-template-columns: 1fr;
          grid-template-rows: auto auto auto;
        }

        .mapping-controls {
          flex-direction: row;
          justify-content: center;
          grid-column: 1;
          grid-row: 2;
        }

        .event-details-container {
          background-color: #f8f9fa;
          padding: 20px;
        }

        .event-details-header {
          display: flex;
          flex-direction: column;
          margin-bottom: 30px;
          position: relative;
        }

        .event-details-header .header-content {
          text-align: center;
          padding: 20px 0;
          position: relative;
        }

        .event-badge {
          position: absolute;
          top: -15px;
          left: 50%;
          transform: translateX(-50%);
          background: linear-gradient(135deg, #4361ee, #3a0ca3);
          color: white;
          width: 60px;
          height: 60px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-weight: bold;
          font-size: 18px;
          box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
          z-index: 2;
        }

        .event-details-header h2 {
          font-size: 28px;
          color: var(--dark-color);
          margin: 15px 0 10px;
          font-weight: 700;
        }

        .event-meta {
          display: flex;
          justify-content: center;
          gap: 20px;
          flex-wrap: wrap;
        }

        .meta-item {
          display: flex;
          align-items: center;
          gap: 5px;
          color: #555;
          font-size: 14px;
        }

        .event-details-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 20px;
        }

        .detail-card {
          background-color: white;
          border-radius: 12px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
          overflow: hidden;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .detail-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        .main-card {
          grid-column: 1 / -1;
        }

        .card-header {
          padding: 15px 20px;
          background: linear-gradient(135deg, #f8f9fa, #e9ecef);
          border-bottom: 1px solid #eee;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .card-header h3 {
          font-size: 18px;
          color: var(--dark-color);
          margin: 0;
          display: flex;
          align-items: center;
          gap: 10px;
        }

        .card-header h3 i {
          color: var(--primary-color);
        }

        .view-all {
          color: var(--primary-color);
          font-size: 14px;
          cursor: pointer;
          font-weight: 500;
        }

        .view-all:hover {
          text-decoration: underline;
        }

        .card-content {
          padding: 20px;
        }

        .event-image-container {
          position: relative;
          border-radius: 10px;
          overflow: hidden;
          margin-bottom: 20px;
        }

        .event-detail-image {
          width: 100%;
          height: 300px;
          object-fit: cover;
          display: block;
        }

        .image-overlay {
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
          padding: 20px;
          display: flex;
          justify-content: center;
        }

        .event-description {
          line-height: 1.6;
          color: #555;
        }

        .event-description h4 {
          color: var(--dark-color);
          margin-top: 0;
        }

        .stats-container {
          display: flex;
          gap: 20px;
          margin-top: 20px;
        }

        .stat-item {
          text-align: center;
          padding: 15px;
          background-color: #f8f9fa;
          border-radius: 8px;
          flex: 1;
        }

        .stat-value {
          font-size: 24px;
          font-weight: 700;
          color: var(--primary-color);
        }

        .stat-label {
          font-size: 14px;
          color: #777;
        }

        .participants-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 15px;
        }

        .participant-item {
          display: flex;
          align-items: center;
          gap: 10px;
          padding: 10px;
          border-radius: 8px;
          background-color: #f8f9fa;
          transition: all 0.3s ease;
        }

        .team-logo {
          width: 40px;
          height: 40px;
          border-radius: 50%;
          object-fit: cover;
        }

        .team-name {
          font-weight: 500;
          color: var(--dark-color);
        }

        .team-record {
          font-size: 12px;
          color: #777;
        }

        .fixtures-list {
          list-style: none;
          padding: 0;
          margin: 0;
        }

        .fixture-item {
          display: flex;
          align-items: center;
          padding: 12px 0;
          border-bottom: 1px solid #eee;
        }

        .fixture-item:last-child {
          border-bottom: none;
        }

        .fixture-status {
          width: 30px;
          height: 30px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          margin-right: 15px;
        }

        .fixture-status.completed {
          background-color: rgba(76, 201, 240, 0.1);
          color: var(--success-color);
        }

        .fixture-status.upcoming {
          background-color: rgba(248, 150, 30, 0.1);
          color: var(--warning-color);
        }

        .fixture-details {
          flex: 1;
        }

        .fixture-name {
          font-weight: 500;
          color: var(--dark-color);
        }

        .fixture-time {
          font-size: 12px;
          color: #777;
        }

        .fixture-action {
          background: none;
          border: none;
          color: var(--primary-color);
          cursor: pointer;
        }

        .no-fixtures {
          text-align: center;
          color: #777;
          padding: 20px 0;
        }

        .venue-map {
          height: 200px;
          background-color: #f8f9fa;
          border-radius: 8px;
          margin-bottom: 15px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #777;
        }

        .map-placeholder {
          text-align: center;
        }

        .map-placeholder i {
          font-size: 40px;
          margin-bottom: 10px;
          color: var(--primary-color);
        }

        .venue-details p {
          margin: 8px 0;
          display: flex;
          align-items: center;
          gap: 8px;
          color: #555;
        }

        .venue-details i {
          color: var(--primary-color);
          width: 20px;
          text-align: center;
        }

        .info-tabs {
          border: 1px solid #eee;
          border-radius: 8px;
          overflow: hidden;
        }

        .tab-header {
          display: flex;
          border-bottom: 1px solid #eee;
        }

        .tab-btn {
          flex: 1;
          padding: 12px;
          background: none;
          border: none;
          cursor: pointer;
          font-weight: 500;
          color: #777;
          transition: all 0.3s ease;
        }

        .tab-btn.active {
          color: var(--primary-color);
          background-color: rgba(67, 97, 238, 0.1);
          border-bottom: 2px solid var(--primary-color);
        }

        .tab-content {
          padding: 15px;
          display: none;
        }

        .tab-content.active {
          display: block;
        }

        .tab-content ul {
          padding-left: 20px;
          margin: 10px 0;
        }

        .tab-content li {
          margin-bottom: 8px;
        }

        .broadcast-logos {
          display: flex;
          gap: 15px;
          margin-top: 15px;
        }

        .broadcast-logo {
          display: flex;
          align-items: center;
          gap: 8px;
          padding: 10px 15px;
          background-color: #f8f9fa;
          border-radius: 6px;
        }

        .broadcast-logo i {
          color: var(--primary-color);
        }

        .sponsors-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
          gap: 15px;
          margin-top: 15px;
        }

        .sponsor-item {
          padding: 15px;
          background-color: #f8f9fa;
          border-radius: 8px;
          text-align: center;
        }

        .sponsor-item i {
          font-size: 24px;
          color: var(--primary-color);
          margin-bottom: 8px;
          display: block;
        }

        @media (max-width: 768px) {
          .event-details-grid {
            grid-template-columns: 1fr;
          }

          .event-meta {
            flex-direction: column;
            gap: 8px;
          }

          .event-detail-image {
            height: 200px;
          }

          .stats-container {
            flex-direction: column;
          }
        }
      }
      /* Add these styles to your existing CSS */

      /* Improved mapping lists for infinite scrolling */
      .mapping-list-content {
        height: 300px;
        overflow-y: auto;
        padding: 10px;
        background-color: #f8f9fa;
        border-radius: 0 0 4px 4px;
      }

      /* Better scrollbar styling */
      .mapping-list-content::-webkit-scrollbar {
        width: 8px;
      }

      .mapping-list-content::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
      }

      .mapping-list-content::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
      }

      .mapping-list-content::-webkit-scrollbar-thumb:hover {
        background: #555;
      }

      /* Loading indicator for infinite scroll */
      .loading-indicator {
        text-align: center;
        padding: 10px;
        color: #666;
        font-style: italic;
      }

      /* Enhanced mapping item styling */
      .mapping-item {
        padding: 10px;
        border: 1px solid #eee;
        border-radius: 4px;
        margin-bottom: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 14px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: white;
      }

      .mapping-item:hover {
        background-color: #f8f9fa;
        border-color: #ddd;
      }

      .mapping-item.selected {
        background-color: rgba(67, 97, 238, 0.1);
        border-color: var(--primary-color);
      }

      /* Fixture details styling */
      .fixture-details {
        font-size: 12px;
        color: #666;
        margin-top: 4px;
      }

      .fixture-details span {
        margin-right: 8px;
      }

      /* Filter section styling */
      .filter-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Sidebar -->
      <aside class="sidebar"></aside>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Navbar -->
        <nav class="navbar"></nav>

        <!-- Content Wrapper -->
        <div class="content-wrapper">
          <!-- Page Header -->
          <div class="page-header">
            <button class="btn btn-primary" id="addEventBtn">
              <i class="fas fa-plus"></i> Add Event
            </button>
          </div>

          <!-- Filter Section -->
          <div class="filter-section">
            <h3 class="filter-title">Filters</h3>
            <div class="filter-form">
              <div class="form-group">
                <label class="form-label">Select Sport</label>
                <select class="form-control" id="sportFilter">
                  <option value="">All Sports</option>
                  <option value="football">Football</option>
                  <option value="basketball">Basketball</option>
                  <option value="tennis">Tennis</option>
                  <option value="cricket">Cricket</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Start Date</label>
                <input
                  type="date"
                  class="form-control"
                  id="startDateFilter"
                  placeholder="YYYY-MM-DD"
                />
              </div>
              <div class="form-group">
                <label class="form-label">End Date</label>
                <input
                  type="date"
                  class="form-control"
                  id="endDateFilter"
                  placeholder="YYYY-MM-DD"
                />
              </div>

              <div class="filter-actions">
                <button class="btn btn-primary" id="applyFiltersBtn">
                  <i class="fas fa-filter"></i> Apply
                </button>
                <button class="btn btn-outline hide" id="mapEventsBtn">
                  <i class="fas fa-map-marked-alt"></i> Map Events
                </button>
              </div>
            </div>
          </div>

          <!-- Mapping Section (Hidden by default) -->
          <div class="mapping-section" id="mappingSection">
            <div class="mapping-header">
              <h3 class="mapping-title">Event Mapping</h3>
              <button class="mapping-close" id="closeMappingBtn">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="mapping-container">
              <div class="mapping-list">
                <div class="mapping-list-header">Pending Events</div>
                <div class="mapping-list-content" id="pendingEventsList">
                  <!-- Pending events will be added here by JavaScript -->
                </div>
              </div>
              <div class="mapping-controls">
                <button
                  class="mapping-btn"
                  id="moveAllRightBtn"
                  title="Move All"
                >
                  <i class="fas fa-angle-double-right"></i>
                </button>
                <button
                  class="mapping-btn"
                  id="moveRightBtn"
                  title="Move Selected"
                >
                  <i class="fas fa-angle-right"></i>
                </button>
                <button
                  class="mapping-btn"
                  id="moveLeftBtn"
                  title="Revert Selected"
                >
                  <i class="fas fa-angle-left"></i>
                </button>
                <button
                  class="mapping-btn"
                  id="moveAllLeftBtn"
                  title="Revert All"
                >
                  <i class="fas fa-angle-double-left"></i>
                </button>
              </div>
              <div class="mapping-list">
                <div class="mapping-list-header">Mapped Events</div>
                <div class="mapping-list-content" id="mappedEventsList">
                  <!-- Mapped events will be added here by JavaScript -->
                </div>
              </div>
            </div>
          </div>

          <!-- Events Table -->
          <div class="table-container">
            <table class="table">
              <thead>
                <tr>
                  <th>Image</th>
                  <th>Event Name</th>
                  <th>Badge</th>
                  <th>Start Date</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="eventsTableBody">
                <!-- Events will be added here by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Add/Edit Event Modal -->
    <div class="modal" id="eventModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="modalTitle">Add Event</h3>
          <button class="modal-close" id="closeModalBtn">&times;</button>
        </div>
        <div class="modal-body">
          <form id="eventForm">
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Event Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="eventName"
                  required
                />
              </div>
              <div class="form-group">
                <label class="form-label">Badge Name</label>
                <input type="text" class="form-control" id="badgeName" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Start Date</label>
                <input
                  type="date"
                  class="form-control"
                  id="startDate"
                  required
                />
              </div>
              <div class="form-group">
                <label class="form-label">About Event</label>
                <textarea
                  class="form-control"
                  id="aboutEvent"
                  rows="3"
                ></textarea>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Multiple Venues?</label>
                <div class="radio-group">
                  <div class="radio-option">
                    <input
                      type="radio"
                      id="multipleVenuesYes"
                      name="multipleVenues"
                      value="yes"
                    />
                    <label for="multipleVenuesYes">Yes</label>
                  </div>
                  <div class="radio-option">
                    <input
                      type="radio"
                      id="multipleVenuesNo"
                      name="multipleVenues"
                      value="no"
                      checked
                    />
                    <label for="multipleVenuesNo">No</label>
                  </div>
                </div>
              </div>
            </div>
            <div class="form-row form-full-row">
              <div class="form-group">
                <label class="form-label">Event Image</label>
                <input
                  type="file"
                  class="form-control"
                  id="eventImage"
                  accept="image/*"
                />
              </div>
            </div>
            <div class="form-row form-full-row">
              <div class="form-group">
                <label class="form-label">Search Sport</label>
                <select class="form-control" id="fixtureSportFilter">
                  <option value="">All Sports</option>
                  <option value="football">Football</option>
                  <option value="basketball">Basketball</option>
                  <option value="tennis">Tennis</option>
                  <option value="cricket">Cricket</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Start Date</label>
                <input
                  type="date"
                  class="form-control"
                  id="fixtureStartDateFilter"
                  placeholder="YYYY-MM-DD"
                />
              </div>
              <div class="form-group">
                <label class="form-label">End Date</label>
                <input
                  type="date"
                  class="form-control"
                  id="fixtureEndDateFilter"
                  placeholder="YYYY-MM-DD"
                />
              </div>
              <div class="form-group">
                <button
                  class="btn btn-primary"
                  id="applyFixtureFiltersBtn"
                  type="button"
                >
                  <i class="fas fa-filter"></i> Apply
                </button>
              </div>
            </div>
          </form>
        </div>
        <!-- Add this inside the modal-body div, after the existing form rows but before the fixtures mapping section -->

        <!-- Update the existing fixtures mapping section by adding the style attributes to the mapping-list-content divs -->
        <div class="form-row form-full-row">
          <div class="form-group">
            <label class="form-label">Fixtures Mapping</label>
            <div class="mapping-container">
              <div class="mapping-list">
                <div class="mapping-list-header">Unmapped Fixtures</div>
                <div
                  class="mapping-list-content"
                  id="unmappedFixturesList"
                  style="height: 300px; overflow-y: auto"
                >
                  <!-- Unmapped fixtures will be added here by JavaScript -->
                </div>
              </div>
              <div class="mapping-controls">
                <button
                  type="button"
                  class="mapping-btn"
                  id="moveAllFixturesRightBtn"
                  title="Move All"
                >
                  <i class="fas fa-angle-double-right"></i>
                </button>
                <button
                  type="button"
                  class="mapping-btn"
                  id="moveFixtureRightBtn"
                  title="Move Selected"
                >
                  <i class="fas fa-angle-right"></i>
                </button>
                <button
                  type="button"
                  class="mapping-btn"
                  id="moveFixtureLeftBtn"
                  title="Revert Selected"
                >
                  <i class="fas fa-angle-left"></i>
                </button>
                <button
                  type="button"
                  class="mapping-btn"
                  id="moveAllFixturesLeftBtn"
                  title="Revert All"
                >
                  <i class="fas fa-angle-double-left"></i>
                </button>
              </div>
              <div class="mapping-list">
                <div class="mapping-list-header">Mapped Fixtures</div>
                <div
                  class="mapping-list-content"
                  id="mappedFixturesList"
                  style="height: 300px; overflow-y: auto"
                >
                  <!-- Mapped fixtures will be added here by JavaScript -->
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-outline" id="cancelModalBtn">Cancel</button>
          <button class="btn btn-primary" id="saveEventBtn">Save</button>
        </div>
      </div>
    </div>
  </body>
  <script type="module">
    import Sidebar from "./sidebar.js";
    import Navbar from "./navbar.js";

    document?.addEventListener("DOMContentLoaded", function () {
      const sidebar = document.querySelector(".sidebar");
      const navbar = document.querySelector(".navbar");
      sidebar.innerHTML = Sidebar("Events");
      navbar.innerHTML = Navbar("Events");

      // Sample data for events
      const events = [
        {
          id: 1,
          name: "Premier League Match",
          badge: "PL",
          startDate: "2025-06-15T20:00:00",
          image: "https://via.placeholder.com/150",
          sport: "football",
          status: "active",
          mappedFixtures: [1, 3],
        },
        {
          id: 2,
          name: "NBA Finals Game 1",
          badge: "NBA",
          startDate: "2025-06-10T19:30:00",
          image: "https://via.placeholder.com/150",
          sport: "basketball",
          status: "active",
          mappedFixtures: [2],
        },
        {
          id: 3,
          name: "Wimbledon Quarterfinals",
          badge: "Grand Slam",
          startDate: "2025-07-05T14:00:00",
          image: "https://via.placeholder.com/150",
          sport: "tennis",
          status: "upcoming",
          mappedFixtures: [4, 5],
        },
        {
          id: 4,
          name: "ICC World Cup",
          badge: "ICC",
          startDate: "2025-10-20T09:00:00",
          image: "https://via.placeholder.com/150",
          sport: "cricket",
          status: "upcoming",
          mappedFixtures: [],
        },
        {
          id: 5,
          name: "Champions League Final",
          badge: "UCL",
          startDate: "2025-05-28T21:00:00",
          image: "https://via.placeholder.com/150",
          sport: "football",
          status: "completed",
          mappedFixtures: [1, 2, 3],
        },
        // Australian Events
        {
          id: 6,
          name: "AFL Grand Final",
          badge: "AFL",
          startDate: "2025-09-30T14:30:00",
          image: "https://via.placeholder.com/150",
          sport: "australian football",
          status: "upcoming",
          mappedFixtures: [6],
        },
        {
          id: 7,
          name: "Australian Open Final",
          badge: "AO",
          startDate: "2025-01-29T17:00:00",
          image: "https://via.placeholder.com/150",
          sport: "tennis",
          status: "completed",
          mappedFixtures: [7, 8],
        },
        {
          id: 8,
          name: "NRL Grand Final",
          badge: "NRL",
          startDate: "2025-10-01T19:00:00",
          image: "https://via.placeholder.com/150",
          sport: "rugby league",
          status: "upcoming",
          mappedFixtures: [9],
        },
        {
          id: 9,
          name: "The Ashes 1st Test",
          badge: "Ashes",
          startDate: "2025-06-16T11:00:00",
          image: "https://via.placeholder.com/150",
          sport: "cricket",
          status: "active",
          mappedFixtures: [10],
        },
        {
          id: 10,
          name: "Australian Grand Prix",
          badge: "F1",
          startDate: "2025-04-02T15:00:00",
          image: "https://via.placeholder.com/150",
          sport: "formula 1",
          status: "completed",
          mappedFixtures: [11],
        },
        {
          id: 11,
          name: "Sydney to Hobart Yacht Race",
          badge: "S2H",
          startDate: "2025-12-26T12:00:00",
          image: "https://via.placeholder.com/150",
          sport: "sailing",
          status: "upcoming",
          mappedFixtures: [12],
        },
        {
          id: 12,
          name: "Melbourne Cup",
          badge: "MC",
          startDate: "2025-11-07T15:00:00",
          image: "https://via.placeholder.com/150",
          sport: "horse racing",
          status: "upcoming",
          mappedFixtures: [],
        },
        {
          id: 13,
          name: "Big Bash League Final",
          badge: "BBL",
          startDate: "2025-02-04T19:30:00",
          image: "https://via.placeholder.com/150",
          sport: "cricket",
          status: "completed",
          mappedFixtures: [13, 14],
        },
        {
          id: 14,
          name: "Super Rugby Pacific Final",
          badge: "SRP",
          startDate: "2025-06-24T19:00:00",
          image: "https://via.placeholder.com/150",
          sport: "rugby union",
          status: "completed",
          mappedFixtures: [15],
        },
        {
          id: 15,
          name: "Australian Baseball League Final",
          badge: "ABL",
          startDate: "2025-01-28T19:00:00",
          image: "https://via.placeholder.com/150",
          sport: "baseball",
          status: "completed",
          mappedFixtures: [16],
        },
        {
          id: 16,
          name: "Netball Australia Championship",
          badge: "NA",
          startDate: "2025-09-15T18:30:00",
          image: "https://via.placeholder.com/150",
          sport: "netball",
          status: "upcoming",
          mappedFixtures: [17],
        },
        {
          id: 17,
          name: "UCI Road World Championships",
          badge: "UCI",
          startDate: "2025-09-23T09:00:00",
          image: "https://via.placeholder.com/150",
          sport: "cycling",
          status: "active",
          mappedFixtures: [18],
        },
        {
          id: 18,
          name: "Hockey Australia League Final",
          badge: "HA",
          startDate: "2025-10-22T19:00:00",
          image: "https://via.placeholder.com/150",
          sport: "hockey",
          status: "upcoming",
          mappedFixtures: [19],
        },
        {
          id: 19,
          name: "Australian Athletics Championships",
          badge: "AAC",
          startDate: "2025-04-15T10:00:00",
          image: "https://via.placeholder.com/150",
          sport: "athletics",
          status: "completed",
          mappedFixtures: [20],
        },
        {
          id: 20,
          name: "Supercars Championship",
          badge: "SC",
          startDate: "2025-08-05T13:30:00",
          image: "https://via.placeholder.com/150",
          sport: "motorsport",
          status: "active",
          mappedFixtures: [],
        },
      ];
      // Enhanced sample data for all fixtures with more details
      const allFixtures = [
        {
          id: 1,
          name: "Fixture A: Team X vs Team Y",
          sport: "football",
          date: "2025-01-15",
          status: "upcoming",
        },
        {
          id: 2,
          name: "Fixture B: Team A vs Team B",
          sport: "basketball",
          date: "2025-02-16",
          status: "upcoming",
        },
        {
          id: 3,
          name: "Fixture C: Player 1 vs Player 2",
          sport: "tennis",
          date: "2025-03-17",
          status: "upcoming",
        },
        {
          id: 4,
          name: "Fixture D: Team M vs Team N",
          sport: "cricket",
          date: "2025-06-18",
          status: "upcoming",
        },
        {
          id: 5,
          name: "Fixture E: Team P vs Team Q",
          sport: "football",
          date: "2025-06-19",
          status: "upcoming",
        },
        {
          id: 6,
          name: "Fixture F: Team R vs Team S",
          sport: "basketball",
          date: "2025-06-20",
          status: "upcoming",
        },
        {
          id: 7,
          name: "Fixture G: Player 3 vs Player 4",
          sport: "tennis",
          date: "2025-06-21",
          status: "upcoming",
        },
        {
          id: 8,
          name: "Fixture H: Team U vs Team V",
          sport: "cricket",
          date: "2025-06-22",
          status: "upcoming",
        },
        {
          id: 9,
          name: "Fixture I: Team W vs Team Z",
          sport: "football",
          date: "2025-06-23",
          status: "upcoming",
        },
        {
          id: 10,
          name: "Fixture J: Team K vs Team L",
          sport: "basketball",
          date: "2025-06-24",
          status: "upcoming",
        },
        {
          id: 11,
          name: "Fixture K: Player 5 vs Player 6",
          sport: "tennis",
          date: "2025-06-25",
          status: "upcoming",
        },
        {
          id: 12,
          name: "Fixture L: Team O vs Team P",
          sport: "cricket",
          date: "2025-06-26",
          status: "upcoming",
        },
      ];

      // Variables for infinite scrolling
      let currentPage = 1;
      const fixturesPerPage = 5;
      let filteredFixtures = [...allFixtures];
      let isFetching = false;

      // DOM Elements for fixtures filtering
      const fixtureSportFilter = document.getElementById("fixtureSportFilter");
      const fixtureStartDateFilter = document.getElementById(
        "fixtureStartDateFilter"
      );
      const fixtureEndDateFilter = document.getElementById(
        "fixtureEndDateFilter"
      );
      const applyFixtureFiltersBtn = document.getElementById(
        "applyFixtureFiltersBtn"
      );
      const unmappedFixturesList = document.getElementById(
        "unmappedFixturesList"
      );

      // Set up infinite scroll for unmapped fixtures
      unmappedFixturesList.addEventListener("scroll", function () {
        if (isFetching) return;

        const { scrollTop, scrollHeight, clientHeight } = unmappedFixturesList;
        if (scrollTop + clientHeight >= scrollHeight - 10) {
          loadMoreFixtures();
        }
      });

      // Function to load more fixtures
      function loadMoreFixtures() {
        if (isFetching) return;

        isFetching = true;
        currentPage++;

        // Simulate API delay
        setTimeout(() => {
          renderFixturesLists();
          isFetching = false;
        }, 500);
      }

      // Function to filter fixtures based on criteria
      function filterFixtures() {
        const sport = fixtureSportFilter.value;
        const startDate = fixtureStartDateFilter.value;
        const endDate = fixtureEndDateFilter.value;

        filteredFixtures = allFixtures.filter((fixture) => {
          // Filter by sport
          if (sport && fixture.sport !== sport) return false;

          // Filter by date range
          if (startDate && fixture.date < startDate) return false;
          if (endDate && fixture.date > endDate) return false;

          return true;
        });

        currentPage = 1;
        renderFixturesLists();
      }

      // Modified renderFixturesLists function to implement pagination
      function renderFixturesLists() {
        const startIdx = 0;
        const endIdx = currentPage * fixturesPerPage;
        const fixturesToShow = filteredFixtures.slice(0, endIdx);

        // Clear only if it's the first page
        if (currentPage === 1) {
          unmappedFixturesList.innerHTML = "";
        }

        // Unmapped fixtures (filter out already mapped fixtures)
        const unmappedFixtures = fixturesToShow.filter(
          (f) => !currentEventMappedFixtures.includes(f.id)
        );

        unmappedFixtures.forEach((fixture) => {
          const isSelected = selectedUnmappedFixtures.includes(fixture.id);
          const item = document.createElement("div");
          item.className = `mapping-item ${isSelected ? "selected" : ""}`;
          item.setAttribute("data-id", fixture.id);

          // Add more fixture details to the display
          item.innerHTML = `
                    <div>
                        <strong>${fixture.name}</strong>
                        <div style="font-size: 12px; color: #666;">
                            <span>${
                              fixture.sport.charAt(0).toUpperCase() +
                              fixture.sport.slice(1)
                            }</span> | 
                            <span>${new Date(
                              fixture.date
                            ).toLocaleDateString()}</span> | 
                            <span class="badge ${
                              fixture.status === "completed"
                                ? "badge-success"
                                : "badge-warning"
                            }">
                                ${fixture.status}
                            </span>
                        </div>
                    </div>
                `;

          item?.addEventListener("click", function () {
            const fixtureId = parseInt(this.getAttribute("data-id"));
            toggleUnmappedFixtureSelection(fixtureId);
          });

          // Only append if not already in the list
          if (
            !document.querySelector(
              `#unmappedFixturesList [data-id="${fixture.id}"]`
            )
          ) {
            unmappedFixturesList.appendChild(item);
          }
        });

        // Mapped fixtures (in the order they're stored)
        mappedFixturesList.innerHTML = "";

        currentEventMappedFixtures.forEach((fixtureId) => {
          const fixture = allFixtures.find((f) => f.id === fixtureId);
          if (!fixture) return;

          const isSelected = selectedMappedFixtures.includes(fixture.id);
          const item = document.createElement("div");
          item.className = `mapping-item ${isSelected ? "selected" : ""}`;
          item.setAttribute("data-id", fixture.id);

          item.innerHTML = `
                    <div>
                        <strong>${fixture.name}</strong>
                        <div style="font-size: 12px; color: #666;">
                            <span>${
                              fixture.sport.charAt(0).toUpperCase() +
                              fixture.sport.slice(1)
                            }</span> | 
                            <span>${new Date(
                              fixture.date
                            ).toLocaleDateString()}</span> | 
                            <span class="badge ${
                              fixture.status === "completed"
                                ? "badge-success"
                                : "badge-warning"
                            }">
                                ${fixture.status}
                            </span>
                        </div>
                    </div>
                    <div class="mapped-item-controls">
                        <button class="mapped-item-btn up-btn" title="Move up" data-id="${
                          fixture.id
                        }">
                            <i class="fas fa-arrow-up"></i>
                        </button>
                        <button class="mapped-item-btn down-btn" title="Move down" data-id="${
                          fixture.id
                        }">
                            <i class="fas fa-arrow-down"></i>
                        </button>
                    </div>
                `;

          item?.addEventListener("click", function (e) {
            // Don't toggle selection if clicking on controls
            if (e.target.closest(".mapped-item-controls")) return;

            const fixtureId = parseInt(this.getAttribute("data-id"));
            toggleMappedFixtureSelection(fixtureId);
          });

          mappedFixturesList.appendChild(item);
        });

        // Add event listeners to up/down buttons
        document.querySelectorAll(".up-btn").forEach((btn) => {
          btn?.addEventListener("click", function (e) {
            e.stopPropagation();
            const fixtureId = parseInt(this.getAttribute("data-id"));
            moveMappedFixtureUp(fixtureId);
          });
        });

        document.querySelectorAll(".down-btn").forEach((btn) => {
          btn?.addEventListener("click", function (e) {
            e.stopPropagation();
            const fixtureId = parseInt(this.getAttribute("data-id"));
            moveMappedFixtureDown(fixtureId);
          });
        });
      }

      // Setup event listeners for fixture filters
      applyFixtureFiltersBtn?.addEventListener("click", filterFixtures);

      // Set default dates for fixture filters
      const today = new Date().toISOString().split("T")[0];
      const nextWeek = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)
        .toISOString()
        .split("T")[0];
      fixtureStartDateFilter.value = today;
      fixtureEndDateFilter.value = nextWeek;

      // Sample data for pending events (for mapping)
      const pendingEvents = [
        { id: 6, name: "MLB All-Star Game" },
        { id: 7, name: "Tour de France Stage 1" },
        { id: 8, name: "US Open Golf Championship" },
        { id: 9, name: "Formula 1 Monaco GP" },
        { id: 10, name: "Olympic 100m Final" },
      ];

      // Sample data for mapped events (initially empty)
      let mappedEvents = [];

      // DOM Elements
      const navbarToggle = document.getElementById("navbarToggle");
      const eventsTableBody = document.getElementById("eventsTableBody");
      const sportFilter = document.getElementById("sportFilter");
      const startDateFilter = document.getElementById("startDateFilter");
      const endDateFilter = document.getElementById("endDateFilter");
      const applyFiltersBtn = document.getElementById("applyFiltersBtn");
      const mapEventsBtn = document.getElementById("mapEventsBtn");
      const mappingSection = document.getElementById("mappingSection");
      const closeMappingBtn = document.getElementById("closeMappingBtn");
      const pendingEventsList = document.getElementById("pendingEventsList");
      const mappedEventsList = document.getElementById("mappedEventsList");
      const moveAllRightBtn = document.getElementById("moveAllRightBtn");
      const moveRightBtn = document.getElementById("moveRightBtn");
      const moveLeftBtn = document.getElementById("moveLeftBtn");
      const moveAllLeftBtn = document.getElementById("moveAllLeftBtn");
      const eventModal = document.getElementById("eventModal");
      const modalTitle = document.getElementById("modalTitle");
      const eventForm = document.getElementById("eventForm");
      const addEventBtn = document.getElementById("addEventBtn");
      const closeModalBtn = document.getElementById("closeModalBtn");
      const cancelModalBtn = document.getElementById("cancelModalBtn");
      const saveEventBtn = document.getElementById("saveEventBtn");
      const mappedFixturesList = document.getElementById("mappedFixturesList");
      const moveAllFixturesRightBtn = document.getElementById(
        "moveAllFixturesRightBtn"
      );
      const moveFixtureRightBtn = document.getElementById(
        "moveFixtureRightBtn"
      );
      const moveFixtureLeftBtn = document.getElementById("moveFixtureLeftBtn");
      const moveAllFixturesLeftBtn = document.getElementById(
        "moveAllFixturesLeftBtn"
      );
      const upFixtureBtn = document.getElementById("upFixtureBtn");
      const downFixtureBtn = document.getElementById("downFixtureBtn");
      const menuToggle = document.querySelector(".menu-toggle");

      // Current state
      let currentEventId = null;
      let selectedPendingEvents = [];
      let selectedMappedEvents = [];
      let selectedUnmappedFixtures = [];
      let selectedMappedFixtures = [];
      let currentEventMappedFixtures = [];

      // Initialize the page
      function init() {
        renderEventsTable(events);
        setupEventListeners();

        // Set default dates for filters
        // const today = new Date().toISOString().split("T")[0];
        // startDateFilter.value = today;
        // endDateFilter.value = today;
      }

      // Toggle sidebar on mobile
      function toggleSidebar() {
        sidebar.classList.toggle("active");
      }

      // Render events table
      function renderEventsTable(eventsToRender) {
        eventsTableBody.innerHTML = "";

        if (eventsToRender.length === 0) {
          eventsTableBody.innerHTML =
            '<tr><td colspan="5" style="text-align: center;">No events found</td></tr>';
          return;
        }

        eventsToRender.forEach((event) => {
          const row = document.createElement("tr");

          // Format date
          const eventDate = new Date(event.startDate);
          const formattedDate = eventDate.toLocaleDateString("en-US", {
            year: "numeric",
            month: "short",
            day: "numeric",
            hour: "2-digit",
            minute: "2-digit",
          });

          // Determine badge class based on status
          let badgeClass = "badge-primary";
          if (event.status === "completed") badgeClass = "badge-success";
          if (event.status === "upcoming") badgeClass = "badge-warning";

          row.innerHTML = `
                    <td>
                        <div id="eventListImg"><img src="${event.image}" alt="${event.name}" class="event-image"></div>
                    </td>
                    <td>${event.name}</td>
                    <td><span class="badge ${badgeClass}">${event.badge}</span></td>
                    <td>${formattedDate}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn view-event-btn" data-id="${event.id}" title="View">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn edit-event-btn" data-id="${event.id}" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </td>
                `;

          eventsTableBody.appendChild(row);
        });

        // Add event listeners to action buttons
        document.querySelectorAll(".view-event-btn").forEach((btn) => {
          btn?.addEventListener("click", function () {
            const eventId = parseInt(this.getAttribute("data-id"));
            showEventDetails(eventId);
          });
        });

        document.querySelectorAll(".edit-event-btn").forEach((btn) => {
          btn?.addEventListener("click", function () {
            const eventId = parseInt(this.getAttribute("data-id"));
            openEditEventModal(eventId);
          });
        });
      }

      // View event details
      function viewEventDetails(eventId) {
        alert(
          `Viewing event details for ID: ${eventId}\nIn a real implementation, this would navigate to the event details page`
        );
      }

      // Open edit event modal
      function openEditEventModal(eventId) {
        const event = events.find((e) => e.id === eventId);
        if (!event) return;

        currentEventId = eventId;
        modalTitle.textContent = "Edit Event";
        currentEventMappedFixtures = [...event.mappedFixtures];

        // Fill form with event data
        document.getElementById("eventName").value = event.name;
        document.getElementById("badgeName").value = event.badge;

        // Format date for datetime-local input
        const eventDate = new Date(event.startDate);
        const formattedDate = eventDate.toISOString().slice(0, 16);
        document.getElementById("startDate").value = formattedDate;

        document.getElementById("aboutEvent").value =
          "Sample event description. This would be loaded from the event data in a real implementation.";

        // Set multiple venues radio
        if (event.multipleVenues) {
          document.getElementById("multipleVenuesYes").checked = true;
        } else {
          document.getElementById("multipleVenuesNo").checked = true;
        }

        // Render fixtures lists
        renderFixturesLists();

        // Show modal
        eventModal.style.display = "block";
      }

      // Open add event modal
      function openAddEventModal() {
        currentEventId = null;
        currentEventMappedFixtures = [];

        // Reset form
        eventForm.reset();
        document.getElementById("multipleVenuesNo").checked = true;

        // Render fixtures lists
        renderFixturesLists();

        // Show modal
        eventModal.style.display = "block";
      }

      // Render pending and mapped events lists
      function renderEventsLists() {
        pendingEventsList.innerHTML = "";
        mappedEventsList.innerHTML = "";

        // Pending events (filter out already mapped events)
        const availablePendingEvents = pendingEvents.filter(
          (pe) => !mappedEvents.some((me) => me.id === pe.id)
        );

        availablePendingEvents.forEach((event) => {
          const isSelected = selectedPendingEvents.includes(event.id);
          const item = document.createElement("div");
          item.className = `mapping-item ${isSelected ? "selected" : ""}`;
          item.setAttribute("data-id", event.id);
          item.innerHTML = event.name;

          item?.addEventListener("click", function () {
            const eventId = parseInt(this.getAttribute("data-id"));
            togglePendingEventSelection(eventId);
          });

          pendingEventsList.appendChild(item);
        });

        // Mapped events
        mappedEvents.forEach((event, index) => {
          const isSelected = selectedMappedEvents.includes(event.id);
          const item = document.createElement("div");
          item.className = `mapping-item ${isSelected ? "selected" : ""}`;
          item.setAttribute("data-id", event.id);

          item.innerHTML = `
                    ${event.name}
                    <div class="mapped-item-controls">
                        <button class="mapped-item-btn up-btn" title="Move up" data-id="${event.id}">
                            <i class="fas fa-arrow-up"></i>
                        </button>
                        <button class="mapped-item-btn down-btn" title="Move down" data-id="${event.id}">
                            <i class="fas fa-arrow-down"></i>
                        </button>
                    </div>
                `;

          item?.addEventListener("click", function (e) {
            // Don't toggle selection if clicking on controls
            if (e.target.closest(".mapped-item-controls")) return;

            const eventId = parseInt(this.getAttribute("data-id"));
            toggleMappedEventSelection(eventId);
          });

          mappedEventsList.appendChild(item);
        });

        // Add event listeners to up/down buttons
        document.querySelectorAll(".up-btn").forEach((btn) => {
          btn?.addEventListener("click", function (e) {
            e.stopPropagation();
            const eventId = parseInt(this.getAttribute("data-id"));
            moveMappedEventUp(eventId);
          });
        });

        document.querySelectorAll(".down-btn").forEach((btn) => {
          btn?.addEventListener("click", function (e) {
            e.stopPropagation();
            const eventId = parseInt(this.getAttribute("data-id"));
            moveMappedEventDown(eventId);
          });
        });
      }

      // Move mapped event up in order
      function moveMappedEventUp(eventId) {
        const index = mappedEvents.findIndex((e) => e.id === eventId);
        if (index <= 0) return;

        // Swap with previous item
        [mappedEvents[index], mappedEvents[index - 1]] = [
          mappedEvents[index - 1],
          mappedEvents[index],
        ];
        renderEventsLists();
      }

      // Move mapped event down in order
      function moveMappedEventDown(eventId) {
        const index = mappedEvents.findIndex((e) => e.id === eventId);
        if (index === -1 || index >= mappedEvents.length - 1) return;

        // Swap with next item
        [mappedEvents[index], mappedEvents[index + 1]] = [
          mappedEvents[index + 1],
          mappedEvents[index],
        ];
        renderEventsLists();
      }

      // Toggle pending event selection
      function togglePendingEventSelection(eventId) {
        const index = selectedPendingEvents.indexOf(eventId);
        if (index === -1) {
          selectedPendingEvents.push(eventId);
        } else {
          selectedPendingEvents.splice(index, 1);
        }

        // Update UI
        const item = pendingEventsList.querySelector(`[data-id="${eventId}"]`);
        if (item) {
          item.classList.toggle("selected");
        }
      }

      // Toggle mapped event selection
      function toggleMappedEventSelection(eventId) {
        const index = selectedMappedEvents.indexOf(eventId);
        if (index === -1) {
          selectedMappedEvents.push(eventId);
        } else {
          selectedMappedEvents.splice(index, 1);
        }

        // Update UI
        const item = mappedEventsList.querySelector(`[data-id="${eventId}"]`);
        if (item) {
          item.classList.toggle("selected");
        }
      }

      // Toggle unmapped fixture selection
      function toggleUnmappedFixtureSelection(fixtureId) {
        const index = selectedUnmappedFixtures.indexOf(fixtureId);
        if (index === -1) {
          selectedUnmappedFixtures.push(fixtureId);
        } else {
          selectedUnmappedFixtures.splice(index, 1);
        }

        // Update UI
        const item = unmappedFixturesList.querySelector(
          `[data-id="${fixtureId}"]`
        );
        if (item) {
          item.classList.toggle("selected");
        }
      }

      // Toggle mapped fixture selection
      function toggleMappedFixtureSelection(fixtureId) {
        const index = selectedMappedFixtures.indexOf(fixtureId);
        if (index === -1) {
          selectedMappedFixtures.push(fixtureId);
        } else {
          selectedMappedFixtures.splice(index, 1);
        }

        // Update UI
        const item = mappedFixturesList.querySelector(
          `[data-id="${fixtureId}"]`
        );
        if (item) {
          item.classList.toggle("selected");
        }
      }

      // Move selected pending events to mapped
      function moveSelectedPendingToMapped() {
        if (selectedPendingEvents.length === 0) {
          alert("Please select at least one event to move");
          return;
        }

        selectedPendingEvents.forEach((eventId) => {
          const event = pendingEvents.find((e) => e.id === eventId);
          if (event && !mappedEvents.some((e) => e.id === eventId)) {
            mappedEvents.push(event);
          }
        });

        selectedPendingEvents = [];
        renderEventsLists();
      }

      // Move all pending events to mapped
      function moveAllPendingToMapped() {
        pendingEvents.forEach((event) => {
          if (!mappedEvents.some((e) => e.id === event.id)) {
            mappedEvents.push(event);
          }
        });

        selectedPendingEvents = [];
        renderEventsLists();
      }

      // Revert selected mapped events to pending
      function revertSelectedMappedToPending() {
        if (selectedMappedEvents.length === 0) {
          alert("Please select at least one event to revert");
          return;
        }

        mappedEvents = mappedEvents.filter(
          (event) => !selectedMappedEvents.includes(event.id)
        );

        selectedMappedEvents = [];
        renderEventsLists();
      }

      // Revert all mapped events to pending
      function revertAllMappedToPending() {
        mappedEvents = [];
        selectedMappedEvents = [];
        renderEventsLists();
      }

      // Move selected unmapped fixtures to mapped
      function moveSelectedFixturesToMapped() {
        if (selectedUnmappedFixtures.length === 0) {
          alert("Please select at least one fixture to move");
          return;
        }

        selectedUnmappedFixtures.forEach((fixtureId) => {
          if (!currentEventMappedFixtures.includes(fixtureId)) {
            currentEventMappedFixtures.push(fixtureId);
          }
        });

        selectedUnmappedFixtures = [];
        renderFixturesLists();
      }

      // Move all unmapped fixtures to mapped
      function moveAllFixturesToMapped() {
        allFixtures.forEach((fixture) => {
          if (!currentEventMappedFixtures.includes(fixture.id)) {
            currentEventMappedFixtures.push(fixture.id);
          }
        });

        selectedUnmappedFixtures = [];
        renderFixturesLists();
      }

      // Revert selected mapped fixtures to unmapped
      function revertSelectedFixturesToUnmapped() {
        if (selectedMappedFixtures.length === 0) {
          alert("Please select at least one fixture to revert");
          return;
        }

        currentEventMappedFixtures = currentEventMappedFixtures.filter(
          (id) => !selectedMappedFixtures.includes(id)
        );

        selectedMappedFixtures = [];
        renderFixturesLists();
      }

      // Revert all mapped fixtures to unmapped
      function revertAllFixturesToUnmapped() {
        currentEventMappedFixtures = [];
        selectedMappedFixtures = [];
        renderFixturesLists();
      }

      // Move mapped fixture up in order
      function moveMappedFixtureUp(fixtureId) {
        const index = currentEventMappedFixtures.indexOf(fixtureId);
        if (index <= 0) return;

        // Swap with previous item
        [
          currentEventMappedFixtures[index],
          currentEventMappedFixtures[index - 1],
        ] = [
          currentEventMappedFixtures[index - 1],
          currentEventMappedFixtures[index],
        ];
        renderFixturesLists();
      }

      // Move mapped fixture down in order
      function moveMappedFixtureDown(fixtureId) {
        const index = currentEventMappedFixtures.indexOf(fixtureId);
        if (index === -1 || index >= currentEventMappedFixtures.length - 1)
          return;

        // Swap with next item
        [
          currentEventMappedFixtures[index],
          currentEventMappedFixtures[index + 1],
        ] = [
          currentEventMappedFixtures[index + 1],
          currentEventMappedFixtures[index],
        ];
        renderFixturesLists();
      }

      // Apply filters to events
      function applyFilters() {
        const sport = sportFilter.value;
        const startDate = startDateFilter.value;
        const endDate = endDateFilter.value;

        let filteredEvents = [...events];

        // Filter by sport
        if (sport) {
          filteredEvents = filteredEvents.filter(
            (event) => event.sport === sport
          );
        }

        // Filter by start date
        if (startDate) {
          filteredEvents = filteredEvents.filter((event) => {
            const eventDate = new Date(event.startDate)
              .toISOString()
              .split("T")[0];
            return eventDate >= startDate;
          });
        }

        // Filter by end date
        if (endDate) {
          filteredEvents = filteredEvents.filter((event) => {
            const eventDate = new Date(event.startDate)
              .toISOString()
              .split("T")[0];
            return eventDate <= endDate;
          });
        }

        console.log(sport, startDate, endDate);

        renderEventsTable(filteredEvents);
      }

      // Save event (add or update)
      function saveEvent() {
        // Validate form
        if (!eventForm.checkValidity()) {
          eventForm.reportValidity();
          return false;
        }

        const eventName = document.getElementById("eventName").value;
        const badgeName = document.getElementById("badgeName").value;
        const startDate = document.getElementById("startDate").value;
        const aboutEvent = document.getElementById("aboutEvent").value;
        const multipleVenues =
          document.getElementById("multipleVenuesYes").checked;

        if (currentEventId) {
          // Update existing event
          const eventIndex = events.findIndex((e) => e.id === currentEventId);
          if (eventIndex !== -1) {
            events[eventIndex] = {
              ...events[eventIndex],
              name: eventName,
              badge: badgeName,
              startDate: startDate,
              aboutEvent: aboutEvent,
              multipleVenues: multipleVenues,
              mappedFixtures: [...currentEventMappedFixtures],
            };
          }
        } else {
          // Add new event
          const newId = Math.max(...events.map((e) => e.id), 0) + 1;
          events.push({
            id: newId,
            name: eventName,
            badge: badgeName,
            startDate: startDate,
            image: "https://via.placeholder.com/150",
            sport: "football", // Default, would be from form in real implementation
            status: "upcoming", // Default
            aboutEvent: aboutEvent,
            multipleVenues: multipleVenues,
            mappedFixtures: [...currentEventMappedFixtures],
          });
        }

        return true;
      }

      // Show event details
      function showEventDetails(eventId) {
        const event = events.find((e) => e.id === eventId);
        if (!event) return;

        // Hide table and show details section
        document.querySelector(".table-container").style.display = "none";
        document.querySelector(".filter-section").style.display = "none";
        document.querySelector(".page-header").style.display = "none";

        // Create or show details container
        let detailsContainer = document.getElementById("eventDetailsContainer");
        if (!detailsContainer) {
          detailsContainer = document.createElement("div");
          detailsContainer.id = "eventDetailsContainer";
          detailsContainer.className = "event-details-container";
          document
            .querySelector(".content-wrapper")
            .appendChild(detailsContainer);
        } else {
          detailsContainer.style.display = "block";
        }

        // Format date and time separately
        const eventDate = new Date(event.startDate);
        const formattedDate = eventDate.toLocaleDateString("en-US", {
          year: "numeric",
          month: "long",
          day: "numeric",
        });
        const formattedTime = eventDate.toLocaleTimeString("en-US", {
          hour: "2-digit",
          minute: "2-digit",
        });

        // Get mapped fixtures with more details
        const mappedFixtures = event.mappedFixtures
          .map((fixtureId) => {
            const fixture = allFixtures.find((f) => f.id === fixtureId);
            return fixture
              ? {
                  name: fixture.name,
                  status: Math.random() > 0.5 ? "completed" : "upcoming", // Sample status
                  time: new Date(
                    Date.now() + Math.random() * 10 * 24 * 60 * 60 * 1000
                  ).toLocaleTimeString([], {
                    hour: "2-digit",
                    minute: "2-digit",
                  }),
                }
              : null;
          })
          .filter((f) => f);

        // Generate participants data (sample)
        const participants = [];
        for (let i = 1; i <= 8; i++) {
          participants.push({
            id: i,
            name: `Team ${i}`,
            logo: `https://via.placeholder.com/80?text=Team${i}`,
            wins: Math.floor(Math.random() * 10),
            losses: Math.floor(Math.random() * 5),
          });
        }

        // Render enhanced event details
        detailsContainer.innerHTML = `
                <div class="event-details-header">
                    <button class="btn btn-outline back-to-events-btn">
                        <i class="fas fa-arrow-left"></i> Back to Events
                    </button>
                    <div class="header-content">
                        <h2>${event.name}</h2>
                        <div class="event-meta">
                            <span class="meta-item"><i class="fas fa-calendar-day"></i> ${formattedDate}</span>
                            <span class="meta-item"><i class="fas fa-clock"></i> ${formattedTime}</span>
                            <span class="meta-item"><i class="fas fa-running"></i> ${
                              event.sport.charAt(0).toUpperCase() +
                              event.sport.slice(1)
                            }</span>
                        </div>
                    </div>
                </div>

                <div class="event-details-grid">
                    <!-- Main Event Card -->
                    <div class="detail-card main-card">
                        <div class="card-content">
                            <div class="event-description">
                                <h4>About the Event</h4>
                                <p>${
                                  event.aboutEvent ||
                                  "No description available. This event promises to be an exciting competition featuring top teams from around the world."
                                }</p>
                                <div class="stats-container">
                                    <div class="stat-item">
                                        <div class="stat-value">${
                                          participants.length
                                        }</div>
                                        <div class="stat-label">Teams</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${
                                          mappedFixtures.length
                                        }</div>
                                        <div class="stat-label">Fixtures</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">${
                                          event.multipleVenues
                                            ? "Multiple"
                                            : "Single"
                                        }</div>
                                        <div class="stat-label">Venues</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Venue Card -->
                    <div class="detail-card venue-card">
                        <div class="card-header">
                            <h3><i class="fas fa-map-marker-alt"></i> Venue Information</h3>
                        </div>
                        <div class="card-content">
                            <div class="venue-details">
                                <p><i class="fas fa-building"></i> National Sports Arena</p>
                                <p><i class="fas fa-location-arrow"></i> 123 Sports Lane, Stadium District</p>
                                <p><i class="fas fa-city"></i> Metropolis, MP 12345</p>
                                <p><i class="fas fa-phone"></i> (555) 123-4567</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;

        // Add event listener for back button
        detailsContainer
          .querySelector(".back-to-events-btn")
          ?.addEventListener("click", function () {
            detailsContainer.style.display = "none";
            document.querySelector(".table-container").style.display = "block";
            document.querySelector(".filter-section").style.display = "block";
            document.querySelector(".page-header").style.display = "block";
          });
      }

      // Setup event listeners
      function setupEventListeners() {
        menuToggle?.addEventListener("click", toggleSidebar);
        // Sidebar toggle
        navbarToggle?.addEventListener("click", function () {
          sidebar.classList.toggle("active");
        });

        // Apply filters
        applyFiltersBtn?.addEventListener("click", applyFilters);

        // Map events button
        mapEventsBtn?.addEventListener("click", function () {
          mappingSection.style.display = "block";
          renderEventsLists();
        });

        // Close mapping section
        closeMappingBtn?.addEventListener("click", function () {
          mappingSection.style.display = "none";
          selectedPendingEvents = [];
          selectedMappedEvents = [];
        });

        // Move events between lists
        moveRightBtn?.addEventListener("click", moveSelectedPendingToMapped);
        moveAllRightBtn?.addEventListener("click", moveAllPendingToMapped);
        moveLeftBtn?.addEventListener("click", revertSelectedMappedToPending);
        moveAllLeftBtn?.addEventListener("click", revertAllMappedToPending);

        // Add event button
        addEventBtn?.addEventListener("click", openAddEventModal);

        // Close modal buttons
        closeModalBtn?.addEventListener("click", function () {
          eventModal.style.display = "none";
        });

        cancelModalBtn?.addEventListener("click", function () {
          eventModal.style.display = "none";
        });

        // Save event
        saveEventBtn?.addEventListener("click", function (e) {
          e.preventDefault();

          if (saveEvent()) {
            // Re-render table and close modal
            renderEventsTable(events);
            eventModal.style.display = "none";
          }
        });

        // Move fixtures between lists
        moveFixtureRightBtn?.addEventListener(
          "click",
          moveSelectedFixturesToMapped
        );
        moveAllFixturesRightBtn?.addEventListener(
          "click",
          moveAllFixturesToMapped
        );
        moveFixtureLeftBtn?.addEventListener(
          "click",
          revertSelectedFixturesToUnmapped
        );
        moveAllFixturesLeftBtn?.addEventListener(
          "click",
          revertAllFixturesToUnmapped
        );
      }

      // Initialize the page
      init();
    });
  </script>
</html>
